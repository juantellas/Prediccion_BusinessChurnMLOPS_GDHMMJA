{"version":2,"kind":"Notebook","sha256":"ad6477ab3f599cdef81635b2a443a69a6bab6d92c37d7248913370a8a6891757","slug":"interpretables-resultados","location":"/notebooks/3_interpretables_resultados.ipynb","dependencies":[],"frontmatter":{"title":"3. Interpretabilidad y feature_importance","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"gpu_venv","language":"python"},"authors":[{"nameParsed":{"literal":"Juan Aguirre","given":"Juan","family":"Aguirre"},"name":"Juan Aguirre","id":"contributors-Users\\taran\\OneDrive\\Documents\\uni\\machin\\miniprojects\\RF-XGB\\Prediccion_BusinessChurnMLOPS_GDHMMJA\\docs\\myst-generated-uid-0"},{"nameParsed":{"literal":"Mariangel Mercado","given":"Mariangel","family":"Mercado"},"name":"Mariangel Mercado","id":"contributors-Users\\taran\\OneDrive\\Documents\\uni\\machin\\miniprojects\\RF-XGB\\Prediccion_BusinessChurnMLOPS_GDHMMJA\\docs\\myst-generated-uid-1"},{"nameParsed":{"literal":"Guirlessa de la Hoz","given":"Guirlessa","non_dropping_particle":"de la","family":"Hoz"},"name":"Guirlessa de la Hoz","id":"contributors-Users\\taran\\OneDrive\\Documents\\uni\\machin\\miniprojects\\RF-XGB\\Prediccion_BusinessChurnMLOPS_GDHMMJA\\docs\\myst-generated-uid-2"}],"github":"https://github.com/juantellas","keywords":["Churn","Telecomunicaciones","Machine Learning","Predicci√≥n"],"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"3_interpretables_resultados.ipynb","url":"/3_interpretables_res-3cb2d7dff1602e5bf56338b5e6e27c61.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ahora, usaremos los mejores modelos de cada seccion, y observamos el feature importance de cada uno, ejemplificandolo con diversos casos dentro de los datos estudiados.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kqvkgRJNYs"}],"key":"Vx52qoDh4J"}],"key":"uhiUh8JvHq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom lime.lime_tabular import LimeTabularExplainer\nimport pickle\n\nimport joblib","key":"TBo89fcIv2"},{"type":"output","id":"Oywb1qGQjHwbYCfxc5r7p","data":[],"key":"NlixMOxfsS"}],"key":"m8TYuzj3em"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1 XGBoost Hiperparametrizado","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ho0hx7tD9D"}],"key":"xuO7yTkipk"}],"identifier":"id-3-1-xgboost-hiperparametrizado","label":"3.1 XGBoost Hiperparametrizado","html_id":"id-3-1-xgboost-hiperparametrizado","implicit":true,"key":"RnSDdQiGij"}],"key":"e6A2k3qTBU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acto siguiente, vamos a observar cuales fueron las diez features mas importantes por modelo, de forma descendente.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P6WMDposnL"}],"key":"d7MXUBS9GV"}],"key":"hhytX68l8t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xgb_final = joblib.load(\"xgb_hp_best.pkl\")\n\nxgb_final\n","key":"xUiIA9cz20"},{"type":"output","id":"fLPiuCDD_tG-KEn5VzLDl","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<style>#sk-container-id-10 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-10 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-10 pre {\n  padding: 0;\n}\n\n#sk-container-id-10 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-10 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-10 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-10 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-10 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-10 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-10 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-10 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-10 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-10 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-10 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-10 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-10 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-10 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-10 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"‚ñ∏\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-10 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-10 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-10 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-10 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"‚ñæ\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-10 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-10 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-10 div.sk-label label.sk-toggleable__label,\n#sk-container-id-10 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-10 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-10 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-10 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-10 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-10 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-10 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-10 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-10 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-10 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-10 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-10 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-10\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_mov...\n                               feature_types=None, gamma=1, grow_policy=None,\n                               importance_type=None,\n                               interaction_constraints=None, learning_rate=None,\n                               max_bin=None, max_cat_threshold=None,\n                               max_cat_to_onehot=None, max_delta_step=None,\n                               max_depth=None, max_leaves=None,\n                               min_child_weight=5, missing=nan,\n                               monotone_constraints=None, multi_strategy=None,\n                               n_estimators=None, n_jobs=None,\n                               num_parallel_tree=None, random_state=42, ...))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-66\" type=\"checkbox\" ><label for=\"sk-estimator-id-66\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_mov...\n                               feature_types=None, gamma=1, grow_policy=None,\n                               importance_type=None,\n                               interaction_constraints=None, learning_rate=None,\n                               max_bin=None, max_cat_threshold=None,\n                               max_cat_to_onehot=None, max_delta_step=None,\n                               max_depth=None, max_leaves=None,\n                               min_child_weight=5, missing=nan,\n                               monotone_constraints=None, multi_strategy=None,\n                               n_estimators=None, n_jobs=None,\n                               num_parallel_tree=None, random_state=42, ...))])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-67\" type=\"checkbox\" ><label for=\"sk-estimator-id-67\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>preprocessor: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for preprocessor: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                 [&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]),\n                                (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                 [&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                  &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;,\n                                  &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;,\n                                  &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;,\n                                  &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;,\n                                  &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-68\" type=\"checkbox\" ><label for=\"sk-estimator-id-68\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>num</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-69\" type=\"checkbox\" ><label for=\"sk-estimator-id-69\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-70\" type=\"checkbox\" ><label for=\"sk-estimator-id-70\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>cat</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;, &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;, &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;, &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;, &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;, &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-71\" type=\"checkbox\" ><label for=\"sk-estimator-id-71\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-72\" type=\"checkbox\" ><label for=\"sk-estimator-id-72\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>XGBClassifier</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,\n              colsample_bylevel=None, colsample_bynode=None,\n              colsample_bytree=None, device=None, early_stopping_rounds=None,\n              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,\n              feature_types=None, gamma=1, grow_policy=None,\n              importance_type=None, interaction_constraints=None,\n              learning_rate=None, max_bin=None, max_cat_threshold=None,\n              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,\n              max_leaves=None, min_child_weight=5, missing=nan,\n              monotone_constraints=None, multi_strategy=None, n_estimators=None,\n              n_jobs=None, num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div></div></div></div></div>","content_type":"text/html"},"text/plain":{"content":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('num', StandardScaler(),\n                                                  ['tenure',\n                                                   'charges_monthly']),\n                                                 ('cat',\n                                                  OneHotEncoder(handle_unknown='ignore'),\n                                                  ['gender', 'senior',\n                                                   'partner', 'dependents',\n                                                   'phone', 'phone_multiple',\n                                                   'internet',\n                                                   'internet_security',\n                                                   'internet_backup',\n                                                   'internet_protection',\n                                                   'internet_support',\n                                                   'streaming_tv',\n                                                   'streaming_mov...\n                               feature_types=None, gamma=1, grow_policy=None,\n                               importance_type=None,\n                               interaction_constraints=None, learning_rate=None,\n                               max_bin=None, max_cat_threshold=None,\n                               max_cat_to_onehot=None, max_delta_step=None,\n                               max_depth=None, max_leaves=None,\n                               min_child_weight=5, missing=nan,\n                               monotone_constraints=None, multi_strategy=None,\n                               n_estimators=None, n_jobs=None,\n                               num_parallel_tree=None, random_state=42, ...))])","content_type":"text/plain"}}}],"key":"D9nNWOf37x"}],"key":"a2InW9isYE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xgb_model = list(xgb_final.named_steps.values())[-1] \nfeature_names = xgb_final.named_steps[\"preprocessor\"].get_feature_names_out()\nimportances = xgb_model.feature_importances_\n\nfeat_importance = (\n    pd.DataFrame({\"Feature\": feature_names, \"Importance\": importances})\n    .sort_values(by=\"Importance\", ascending=False)\n    .reset_index(drop=True)\n)\n\ntop10 = feat_importance.head(10)\n\nplt.figure(figsize=(10, 6))\nsns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\nplt.title(\"Top 10 Features m√°s importantes ‚Äî XGBoost + HP\", fontsize=14)\nplt.xlabel(\"Importancia\")\nplt.ylabel(\"Caracter√≠sticas\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"JoJgwqJEr9"},{"type":"output","id":"d4S1GiXX1qu0hSgTb80Hz","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1175004313.py:14: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"823bc6d71a9c1f79f44f3de46bbce370","path":"/823bc6d71a9c1f79f44f3de46bbce370.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"Hs8DWPdGdT"}],"key":"h471nCqEuX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aqui, los features mas importantes fueron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u5qW7SCkZs"}],"key":"qFrw0gPBqM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"cat_contract_Month-to-month, cat_internet_Fiber optic, cat_streaming_movies_Yes, cat_contract_One year, cat_internet_security_no","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"stpojMMqPx"}],"key":"gPqQbhHmj5"}],"key":"S4QbQ1NKE5"}],"key":"RQNjmJfiup"}],"key":"VLsIRWeWvr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1.1 Caso mixto de Churn (i=10)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"svieylgjJo"}],"key":"eLApp6jSmE"}],"identifier":"id-3-1-1-caso-mixto-de-churn-i-10","label":"3.1.1 Caso mixto de Churn (i=10)","html_id":"id-3-1-1-caso-mixto-de-churn-i-10","implicit":true,"key":"ZA8Nc9NfYv"}],"key":"OTv4pzsM1i"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #10 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qgsx5uXB9w"}],"key":"IM4YUW5Nfa"}],"key":"f4YH1cYHfa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = xgb_final.named_steps[\"preprocessor\"]\nclassifier = xgb_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"IJ5wShq2Z4"},{"type":"output","id":"wAgbqSqxC9_SszaJdZ63b","data":[],"key":"b2G63GlMcs"}],"key":"NbPEWOUAU4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"zKLNvPqcw2"},{"type":"output","id":"UwogOSZmMdpiFpyLTuHXU","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #10\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.342 | S√≠: 0.658\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.308844\n                          num__tenure > 0.92 -0.219157\n                 num__charges_monthly > 0.83  0.108097\n     0.00 < cat__internet_support_No <= 1.00  0.082618\n    0.00 < cat__internet_Fiber optic <= 1.00  0.066119\n           cat__internet_security_No <= 0.00 -0.058938\n              cat__contract_One year <= 0.00 -0.051164\n              cat__contract_Two year <= 0.00  0.047030\n0.00 < cat__payment_Electronic check <= 1.00  0.045049\n                  cat__dependents_No <= 0.00 -0.035897\n================================================================================\n"}],"key":"uxbQhIDwxQ"}],"key":"lb2F6GRmCi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10  \nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"q101h5cckM"},{"type":"output","id":"kFUcwAZ3n-Q6oMk64xtYa","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5123443a68fe7fb2bcf0b30dc2e47287","path":"/5123443a68fe7fb2bcf0b30dc2e47287.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"e6d30L1Nao"}],"key":"FnxqKnNONc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî XGBoost + HP (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"DnonkkmMi3"},{"type":"output","id":"MYu0bY3awEN60t6pp3zon","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3241674099.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b1b5c15d6978ef21356e2d117cd78bb","path":"/2b1b5c15d6978ef21356e2d117cd78bb.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"whBDT8R5nu"}],"key":"Qgl8b1LrQe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"üé® Significado de los colores rojo y azul","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PqzvEZ26XF"}],"key":"GraNwIKJDj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"En la gr√°fica que generamos:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qLlXNdmtHU"}],"key":"wrzqfVE45J"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"üî¥ Rojo ‚Üí La caracter√≠stica empuja la predicci√≥n hacia la clase positiva (por ejemplo, ‚ÄúS√≠ churn‚Äù).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AwfQrJeBEO"}],"key":"PVqS8kigtq"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"üîµ Azul ‚Üí La caracter√≠stica empuja la predicci√≥n hacia la clase negativa (por ejemplo, ‚ÄúNo churn‚Äù).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JC0CvpNkQ2"}],"key":"xvc9d8JPHo"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"‚öôÔ∏è Interpretaci√≥n pr√°ctica (en tu contexto de churn)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hQcPXow7La"}],"key":"w33x1lZC9v"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Supongamos que el modelo predice si un cliente har√° churn (‚ÄúS√≠‚Äù) o no (‚ÄúNo‚Äù).\nEntonces:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"x679PZ09wo"}],"key":"pGmn0AvAFQ"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Color\tSignificado\tEjemplo\nüî¥ Rojo\tContribuye a que el modelo prediga ‚ÄúS√≠ churn‚Äù\ttenure bajo o MonthlyCharges alto hacen m√°s probable que se vaya\nüîµ Azul\tContribuye a que el modelo prediga ‚ÄúNo churn‚Äù\ttenure alto o contract tipo ‚Äútwo year‚Äù hacen menos probable que se vaya","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GIJCTryGRh"}],"key":"LCN7f3rOu2"}],"key":"GHGGoKqsKg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1.2 Caso positivo de Churn (i=100)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9FLyb7DBd"}],"key":"X0rZLWIf9H"}],"identifier":"id-3-1-2-caso-positivo-de-churn-i-100","label":"3.1.2 Caso positivo de Churn (i=100)","html_id":"id-3-1-2-caso-positivo-de-churn-i-100","implicit":true,"key":"rf6USCLL6z"}],"key":"WCmbxEL16b"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #100 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uUUoz91iwl"}],"key":"sLGtWRWWP2"}],"key":"dnVEh7PqAm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = xgb_final.named_steps[\"preprocessor\"]\nclassifier = xgb_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"xsTjfryiic"},{"type":"output","id":"m3z4jDwrulEmVYf3aXuca","data":[],"key":"XCCulojkZe"}],"key":"UGH0OJbJkO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"CYYQuN9DlN"},{"type":"output","id":"Zthv50C-itXhzjSJg3K9Q","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #100\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.057 | S√≠: 0.943\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.308345\n                 num__charges_monthly > 0.83  0.114031\n     0.00 < cat__internet_support_No <= 1.00  0.080076\n    0.00 < cat__internet_security_No <= 1.00  0.063614\n    0.00 < cat__internet_Fiber optic <= 1.00  0.062803\n                -0.96 < num__tenure <= -0.14  0.062403\n              cat__contract_One year <= 0.00 -0.056287\n0.00 < cat__payment_Electronic check <= 1.00  0.052427\n              cat__contract_Two year <= 0.00  0.037556\n             cat__internet_backup_No <= 0.00 -0.029726\n================================================================================\n"}],"key":"t2b0p1ZtMm"}],"key":"YRWkNxOqTP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"BVLj7stXx5"},{"type":"output","id":"MDX1dmTF6p9hbhzNHJ81c","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"1546ed04b5bdd61665fb1821390948c4","path":"/1546ed04b5bdd61665fb1821390948c4.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"bEyKH0cVlw"}],"key":"K1eITFmuyD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî XGBoost + HP (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"cKbzYsJxdZ"},{"type":"output","id":"zf49pxIq5NG03mp-Vw9au","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3241674099.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f50e07d60d5b9c437c78786d278975df","path":"/f50e07d60d5b9c437c78786d278975df.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"qwKtEjpLs0"}],"key":"UsYgl78G19"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1.3 Caso negativo de Churn (i=500)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b0z1ylXIuC"}],"key":"ERdWd3J7cz"}],"identifier":"id-3-1-3-caso-negativo-de-churn-i-500","label":"3.1.3 Caso negativo de Churn (i=500)","html_id":"id-3-1-3-caso-negativo-de-churn-i-500","implicit":true,"key":"VqUjLU3C3F"}],"key":"yqUAhgzaUL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #500 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FjEJL9nxA4"}],"key":"n5DTtiOvhl"}],"key":"q7pEx0F4sk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = xgb_final.named_steps[\"preprocessor\"]\nclassifier = xgb_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"LzvA1C2AF3"},{"type":"output","id":"yU5djQ7xAZZkQgzWs7n5i","data":[],"key":"zSNrIJunfy"}],"key":"cAsxdkCblm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"tKNhhFULgq"},{"type":"output","id":"FSaSz06CySlVIQq4c4pzc","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #500\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.950 | S√≠: 0.050\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                       Caracter√≠stica      Peso\n cat__contract_Month-to-month <= 0.00 -0.306627\n                   num__tenure > 0.92 -0.213865\n     cat__internet_support_No <= 0.00 -0.088601\n        num__charges_monthly <= -0.97 -0.078065\n    cat__internet_Fiber optic <= 0.00 -0.061932\n    cat__internet_security_No <= 0.00 -0.059241\n       cat__contract_One year <= 0.00 -0.057930\ncat__payment_Electronic check <= 0.00 -0.049070\n        cat__contract_Two year > 0.00 -0.048957\n      cat__internet_backup_No <= 0.00 -0.033199\n================================================================================\n"}],"key":"YRsqLx9olR"}],"key":"Ww3HqyayfD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"zM1zRlRm0F"},{"type":"output","id":"h8G3cHmetublLdbPsW3sS","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"54603cf3d7afeaa4334052bc235464d6","path":"/54603cf3d7afeaa4334052bc235464d6.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"CTqNsydA8x"}],"key":"laCEH2vHAH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî XGBoost + HP (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"avLmXl5KB1"},{"type":"output","id":"vn_FA3KI0S72BF8d6Jobd","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3241674099.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e18d0306a6bd1bd991b083ad5207d174","path":"/e18d0306a6bd1bd991b083ad5207d174.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"Rap69XeEc8"}],"key":"c4lG87fIEc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2 LightGBM usando Hiperparametrizacion e is_unbalance=True (GPU)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qf1sdkUdAF"}],"key":"APRq1Y1YNj"}],"identifier":"id-3-2-lightgbm-usando-hiperparametrizacion-e-is-unbalance-true-gpu","label":"3.2 LightGBM usando Hiperparametrizacion e is_unbalance=True (GPU)","html_id":"id-3-2-lightgbm-usando-hiperparametrizacion-e-is-unbalance-true-gpu","implicit":true,"key":"q1RZnjLGcH"}],"key":"WwKA3AwKVb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acto siguiente, vamos a observar cuales fueron las diez features mas importantes por modelo, de forma descendente.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PHuN8QguN3"}],"key":"eWciB5RVd6"}],"key":"E1VtAP2VOQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lgb_final = joblib.load(\"lgb_hp_best.pkl\")\n\nlgb_final\n","key":"DClC9GUHLe"},{"type":"output","id":"jglTJCUMg7_-DsZOOGDC-","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<style>#sk-container-id-11 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-11 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-11 pre {\n  padding: 0;\n}\n\n#sk-container-id-11 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-11 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-11 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-11 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-11 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-11 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-11 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-11 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-11 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-11 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-11 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-11 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-11 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-11 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-11 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"‚ñ∏\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-11 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-11 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-11 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-11 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"‚ñæ\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-11 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-11 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-11 div.sk-label label.sk-toggleable__label,\n#sk-container-id-11 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-11 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-11 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-11 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-11 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-11 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-11 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-11 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-11 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-11 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-11 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-11 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-11\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;clf&#x27;,\n                 LGBMClassifier(device=&#x27;gpu&#x27;, is_unbalance=True, max_bin=255,\n                                min_child_samples=50, random_state=42,\n                                reg_alpha=0, reg_lambda=0.5, subsample=0.8))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-73\" type=\"checkbox\" ><label for=\"sk-estimator-id-73\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;clf&#x27;,\n                 LGBMClassifier(device=&#x27;gpu&#x27;, is_unbalance=True, max_bin=255,\n                                min_child_samples=50, random_state=42,\n                                reg_alpha=0, reg_lambda=0.5, subsample=0.8))])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-74\" type=\"checkbox\" ><label for=\"sk-estimator-id-74\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>preprocessor: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for preprocessor: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                 [&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]),\n                                (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                 [&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                  &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;,\n                                  &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;,\n                                  &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;,\n                                  &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;,\n                                  &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-75\" type=\"checkbox\" ><label for=\"sk-estimator-id-75\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>num</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-76\" type=\"checkbox\" ><label for=\"sk-estimator-id-76\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-77\" type=\"checkbox\" ><label for=\"sk-estimator-id-77\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>cat</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;, &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;, &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;, &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;, &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;, &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-78\" type=\"checkbox\" ><label for=\"sk-estimator-id-78\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-79\" type=\"checkbox\" ><label for=\"sk-estimator-id-79\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>LGBMClassifier</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>LGBMClassifier(device=&#x27;gpu&#x27;, is_unbalance=True, max_bin=255,\n               min_child_samples=50, random_state=42, reg_alpha=0,\n               reg_lambda=0.5, subsample=0.8)</pre></div> </div></div></div></div></div></div>","content_type":"text/html"},"text/plain":{"content":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('num', StandardScaler(),\n                                                  ['tenure',\n                                                   'charges_monthly']),\n                                                 ('cat',\n                                                  OneHotEncoder(handle_unknown='ignore'),\n                                                  ['gender', 'senior',\n                                                   'partner', 'dependents',\n                                                   'phone', 'phone_multiple',\n                                                   'internet',\n                                                   'internet_security',\n                                                   'internet_backup',\n                                                   'internet_protection',\n                                                   'internet_support',\n                                                   'streaming_tv',\n                                                   'streaming_movies',\n                                                   'contract', 'paperless',\n                                                   'payment'])])),\n                ('clf',\n                 LGBMClassifier(device='gpu', is_unbalance=True, max_bin=255,\n                                min_child_samples=50, random_state=42,\n                                reg_alpha=0, reg_lambda=0.5, subsample=0.8))])","content_type":"text/plain"}}}],"key":"fTFQtB5RKH"}],"key":"wYhQbRkmX0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lgb_model = list(lgb_final.named_steps.values())[-1] \nfeature_names = lgb_final.named_steps[\"preprocessor\"].get_feature_names_out()\nimportances = lgb_model.feature_importances_\n\nfeat_importance = (\n    pd.DataFrame({\"Feature\": feature_names, \"Importance\": importances})\n    .sort_values(by=\"Importance\", ascending=False)\n    .reset_index(drop=True)\n)\n\n\ntop10 = feat_importance.head(10)\n\n\nplt.figure(figsize=(10, 6))\nsns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\nplt.title(\"Top 10 Features m√°s importantes ‚Äî LightGBM + HP + is_unbalance=True\", fontsize=14)\nplt.xlabel(\"Importancia\")\nplt.ylabel(\"Caracter√≠sticas\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()\n","key":"oYEyRM3DRU"},{"type":"output","id":"CkOmgvN6JErarA6lzsy15","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\2406429536.py:16: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90e116729c43692d549876e39fbe755e","path":"/90e116729c43692d549876e39fbe755e.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"pMP1YWH6bG"}],"key":"HaBnh5DOe0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aqui, los features mas importantes fueron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DdsCdpzPmh"}],"key":"cmtQl7asiD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"num_charges_monthly, num_tenure, cat_payment_Electronic check, cat_dependents_no, cat_internet_security_no","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VFxUb3wily"}],"key":"ArEzy2R1D4"}],"key":"NOazZDLaMc"}],"key":"F2nB0A6Ohx"}],"key":"jq5IqNJ9ZK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2.1 Caso mixto de Churn (i=10)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ub6QyNo4XL"}],"key":"lLtFMuAUxv"}],"identifier":"id-3-2-1-caso-mixto-de-churn-i-10","label":"3.2.1 Caso mixto de Churn (i=10)","html_id":"id-3-2-1-caso-mixto-de-churn-i-10","implicit":true,"key":"x3Gc94ViUE"}],"key":"frQCfF9DF7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #10 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ML9nkpUH6k"}],"key":"cENZzxPNrs"}],"key":"qN1PvqCOab"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = lgb_final.named_steps[\"preprocessor\"]\nclassifier = lgb_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"GnTPAj8Mu9"},{"type":"output","id":"ZMwWY4z-sJk0TY9cyhAYu","data":[],"key":"GCgPXJtfYe"}],"key":"hDfe0Qn8Iq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"MsmYjjObPT"},{"type":"output","id":"Ip04266kxLA9ixOJQG12V","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #10\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.489 | S√≠: 0.511\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.211945\n                          num__tenure > 0.92 -0.178962\n                 num__charges_monthly > 0.83  0.117772\n              cat__contract_Two year <= 0.00  0.091441\n    0.00 < cat__internet_Fiber optic <= 1.00  0.084710\n           cat__internet_security_No <= 0.00 -0.065589\n0.00 < cat__payment_Electronic check <= 1.00  0.055556\n     0.00 < cat__internet_support_No <= 1.00  0.051176\n           cat__payment_Mailed check <= 0.00  0.029493\n              cat__phone_multiple_No <= 0.00  0.028504\n================================================================================\n"},{"name":"stderr","output_type":"stream","text":"c:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\nc:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\n"}],"key":"aQ85UeI5Sc"}],"key":"UFtNPhQF04"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10  \nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"X9tk82cuml"},{"type":"output","id":"HHHWuRCgdmj-C4ki0-dhp","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d1a06686a61226542f76759127d8233c","path":"/d1a06686a61226542f76759127d8233c.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"p3PQ0LNExg"}],"key":"Egyxn6RiMg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî LightGBM + HP + is_unbalance=True (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"bOUbQ0tINI"},{"type":"output","id":"aNQxNtpGMz0cdIWlkC-Em","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\2846921519.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"338804a5e278f7743cc9d532d6f5c31a","path":"/338804a5e278f7743cc9d532d6f5c31a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"wgzc9kqXAO"}],"key":"EST651jF4Z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2.2 Caso positivo de Churn (i=100)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hteq4qd49Z"}],"key":"bNyABwviSK"}],"identifier":"id-3-2-2-caso-positivo-de-churn-i-100","label":"3.2.2 Caso positivo de Churn (i=100)","html_id":"id-3-2-2-caso-positivo-de-churn-i-100","implicit":true,"key":"hKyfAp4GDf"}],"key":"GnfR1OxHxH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #100 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nA5rl27ogo"}],"key":"b2J3UGKUL7"}],"key":"JC20Cf2SZO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = lgb_final.named_steps[\"preprocessor\"]\nclassifier = lgb_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"Lg1ik4iEkV"},{"type":"output","id":"WpFgwnlBttGxYYOn31ccg","data":[],"key":"j993j8Gd50"}],"key":"FsAROmtH3D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"XENsJAUY6D"},{"type":"output","id":"MnX-aMjOTrjsc3aZA0ZI0","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #100\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.092 | S√≠: 0.908\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.214130\n                 num__charges_monthly > 0.83  0.115655\n              cat__contract_Two year <= 0.00  0.102290\n    0.00 < cat__internet_Fiber optic <= 1.00  0.074868\n    0.00 < cat__internet_security_No <= 1.00  0.056041\n     0.00 < cat__internet_support_No <= 1.00  0.053031\n0.00 < cat__payment_Electronic check <= 1.00  0.050408\n                -0.96 < num__tenure <= -0.14  0.038837\n              cat__contract_One year <= 0.00 -0.036699\n           0.00 < cat__dependents_No <= 1.00  0.027543\n================================================================================\n"},{"name":"stderr","output_type":"stream","text":"c:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\nc:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\n"}],"key":"m4bue3160v"}],"key":"N3hK6FBW2b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"EpBMQ4gxLU"},{"type":"output","id":"Iiw2yyCQvBjtDiKNu_QtW","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9a4a7aac2ed28859fc7430a299beedba","path":"/9a4a7aac2ed28859fc7430a299beedba.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"wqOj54M2D0"}],"key":"S1q64TPHYh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî LightGBM + HP + is_unbalance=True (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"P6SuJTIzHx"},{"type":"output","id":"MyVHQeMZOSQ6ysQoGlCpz","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\2846921519.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8efcfe615335d4e59aa569e4db7389d4","path":"/8efcfe615335d4e59aa569e4db7389d4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"Q3nJTgAEyE"}],"key":"Yi1OUqrhG3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2.3 Caso negativo de Churn (i=500)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZCxNJEfvI1"}],"key":"aZQaeEC9Vn"}],"identifier":"id-3-2-3-caso-negativo-de-churn-i-500","label":"3.2.3 Caso negativo de Churn (i=500)","html_id":"id-3-2-3-caso-negativo-de-churn-i-500","implicit":true,"key":"vmN7REiO0L"}],"key":"BloO1Hux4c"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #500 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bb4nJUtJm8"}],"key":"xXeD4znsdA"}],"key":"EQn7ndymwE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = lgb_final.named_steps[\"preprocessor\"]\nclassifier = lgb_final.named_steps[\"clf\"]\n\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"WOzGXnNqP5"},{"type":"output","id":"8xQj3mdDbb8Wpzim1WWAs","data":[],"key":"gDmrku6Dgu"}],"key":"lD7VhvOpaA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"vXAAsyBJAK"},{"type":"output","id":"lE3yhgM0AZRToLH30uQfU","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #500\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.904 | S√≠: 0.096\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                       Caracter√≠stica      Peso\n cat__contract_Month-to-month <= 0.00 -0.209840\n                   num__tenure > 0.92 -0.164397\n        cat__contract_Two year > 0.00 -0.095385\n    cat__internet_Fiber optic <= 0.00 -0.082338\n    cat__internet_security_No <= 0.00 -0.064800\ncat__payment_Electronic check <= 0.00 -0.055262\n        num__charges_monthly <= -0.97 -0.054454\n     cat__internet_support_No <= 0.00 -0.053411\n       cat__contract_One year <= 0.00 -0.034037\n    0.00 < cat__paperless_Yes <= 1.00  0.033337\n================================================================================\n"},{"name":"stderr","output_type":"stream","text":"c:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\nc:\\Users\\taran\\miniconda3\\envs\\gpu_venv\\lib\\site-packages\\sklearn\\utils\\validation.py:2739: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names\n  warnings.warn(\n"}],"key":"tzsbYSV8PK"}],"key":"BEoF9BaPVL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"FUgwo4iS7X"},{"type":"output","id":"V7wNBIx3VKZ11CKLu9dob","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c079b9767772b9330a05c469ef3739f6","path":"/c079b9767772b9330a05c469ef3739f6.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"FE5YSowhfC"}],"key":"OaqkAArt4i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî LightGBM + HP + is_unbalance=True (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"n9ZkJnnqg8"},{"type":"output","id":"vH9llrgTKquOLuJCHjig4","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\2846921519.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8a0c384d45ad718a0ec28f0e43bfb49e","path":"/8a0c384d45ad718a0ec28f0e43bfb49e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"K1s3PQxlO3"}],"key":"RTVrzdld2b"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3 RandomForest usando Hiperparametrizacion y SMOTE (GPU)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kJNGoqXLac"}],"key":"Uu2FfXhRq4"}],"identifier":"id-3-3-randomforest-usando-hiperparametrizacion-y-smote-gpu","label":"3.3 RandomForest usando Hiperparametrizacion y SMOTE (GPU)","html_id":"id-3-3-randomforest-usando-hiperparametrizacion-y-smote-gpu","implicit":true,"key":"gfF0s5n53l"}],"key":"pqn0XjDGvp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acto siguiente, vamos a observar cuales fueron las diez features mas importantes por modelo, de forma descendente.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vCad4wL05j"}],"key":"VcSlXJJdoc"}],"key":"rEjQGrx3TY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rf_final = joblib.load(\"rf_smote_best.pkl\")\n\nrf_final\n","key":"P3Rjwg8oSK"},{"type":"output","id":"3npNgpfZP4zpovg1yUD7m","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<style>#sk-container-id-12 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-12 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-12 pre {\n  padding: 0;\n}\n\n#sk-container-id-12 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-12 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-12 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-12 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-12 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-12 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-12 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-12 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-12 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-12 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-12 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-12 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-12 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-12 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-12 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"‚ñ∏\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-12 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-12 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-12 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-12 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-12 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-12 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-12 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"‚ñæ\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-12 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-12 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-12 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-12 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-12 div.sk-label label.sk-toggleable__label,\n#sk-container-id-12 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-12 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-12 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-12 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-12 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-12 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-12 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-12 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-12 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-12 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-12 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-12 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-12 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-12\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;smote&#x27;, SMOTE(random_state=42)),\n                (&#x27;clf&#x27;,\n                 RandomForestClassifier(max_features=&#x27;log2&#x27;, min_samples_leaf=4,\n                                        random_state=42))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-80\" type=\"checkbox\" ><label for=\"sk-estimator-id-80\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;smote&#x27;, SMOTE(random_state=42)),\n                (&#x27;clf&#x27;,\n                 RandomForestClassifier(max_features=&#x27;log2&#x27;, min_samples_leaf=4,\n                                        random_state=42))])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-81\" type=\"checkbox\" ><label for=\"sk-estimator-id-81\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>preprocessor: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for preprocessor: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                 [&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]),\n                                (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                 [&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                  &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;,\n                                  &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;,\n                                  &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;,\n                                  &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;,\n                                  &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-82\" type=\"checkbox\" ><label for=\"sk-estimator-id-82\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>num</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-83\" type=\"checkbox\" ><label for=\"sk-estimator-id-83\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-84\" type=\"checkbox\" ><label for=\"sk-estimator-id-84\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>cat</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;, &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;, &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;, &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;, &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;, &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-85\" type=\"checkbox\" ><label for=\"sk-estimator-id-85\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-86\" type=\"checkbox\" ><label for=\"sk-estimator-id-86\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>SMOTE</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>SMOTE(random_state=42)</pre></div> </div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-87\" type=\"checkbox\" ><label for=\"sk-estimator-id-87\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>RandomForestClassifier</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestClassifier.html\">?<span>Documentation for RandomForestClassifier</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestClassifier(max_features=&#x27;log2&#x27;, min_samples_leaf=4, random_state=42)</pre></div> </div></div></div></div></div></div>","content_type":"text/html"},"text/plain":{"content":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('num', StandardScaler(),\n                                                  ['tenure',\n                                                   'charges_monthly']),\n                                                 ('cat',\n                                                  OneHotEncoder(handle_unknown='ignore'),\n                                                  ['gender', 'senior',\n                                                   'partner', 'dependents',\n                                                   'phone', 'phone_multiple',\n                                                   'internet',\n                                                   'internet_security',\n                                                   'internet_backup',\n                                                   'internet_protection',\n                                                   'internet_support',\n                                                   'streaming_tv',\n                                                   'streaming_movies',\n                                                   'contract', 'paperless',\n                                                   'payment'])])),\n                ('smote', SMOTE(random_state=42)),\n                ('clf',\n                 RandomForestClassifier(max_features='log2', min_samples_leaf=4,\n                                        random_state=42))])","content_type":"text/plain"}}}],"key":"Ur4TWC4Pn3"}],"key":"uJmVMoA9gU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rf_model = list(rf_final.named_steps.values())[-1] \nfeature_names = rf_final.named_steps[\"preprocessor\"].get_feature_names_out()\nimportances = rf_model.feature_importances_\n\nfeat_importance = (\n    pd.DataFrame({\"Feature\": feature_names, \"Importance\": importances})\n    .sort_values(by=\"Importance\", ascending=False)\n    .reset_index(drop=True)\n)\n\ntop10 = feat_importance.head(10)\n\n\nplt.figure(figsize=(10, 6))\nsns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\nplt.title(\"Top 10 Features m√°s importantes ‚Äî RandomForest + HP + SMOTE\", fontsize=14)\nplt.xlabel(\"Importancia\")\nplt.ylabel(\"Caracter√≠sticas\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()\n","key":"Nwj5A8PZWC"},{"type":"output","id":"AmGFEmFQNAwANqZ_Cxdpb","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1322585804.py:15: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4fd0b5c5f7ed4ba4eb06a038fa10840e","path":"/4fd0b5c5f7ed4ba4eb06a038fa10840e.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"rk0QrS1izk"}],"key":"sa45pTjs5Z"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aqui, los features mas importantes fueron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zCscVUa6zc"}],"key":"EfPEZDWKlj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"num_tenure, cat_contract_Month-to-month, cat_internet_security_no, cat_contract_Two year, y cat_payment_Electronic check","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"myH0wXT1dM"}],"key":"yoiMAhJdTC"}],"key":"tod5KCADPm"}],"key":"AlygPNdP1K"}],"key":"WqL0W7kdAp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.1 Caso mixto de Churn (i=10)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qHLIQSplyy"}],"key":"zfilZVCARg"}],"identifier":"id-3-3-1-caso-mixto-de-churn-i-10","label":"3.3.1 Caso mixto de Churn (i=10)","html_id":"id-3-3-1-caso-mixto-de-churn-i-10","implicit":true,"key":"jcVYs6p0Ww"}],"key":"ci7GfXi2u6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #10 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CGzomRkblP"}],"key":"ay2zSbmVlJ"}],"key":"HijdIrxgF1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = rf_final.named_steps[\"preprocessor\"]\nclassifier = rf_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"BMxA4tWzcg"},{"type":"output","id":"PefaSHO59f81encXvkWbh","data":[],"key":"nsIGcI8zDO"}],"key":"gRh6QH4QVT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"XJOn1csMWX"},{"type":"output","id":"LSH6lz3T_m9RrEeKbpBpU","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #10\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.784 | S√≠: 0.216\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.125976\n              cat__contract_Two year <= 0.00  0.112032\n                          num__tenure > 0.92 -0.065256\n    0.00 < cat__internet_Fiber optic <= 1.00  0.055367\n           cat__internet_security_No <= 0.00 -0.049559\n     0.00 < cat__internet_support_No <= 1.00  0.039823\n              cat__contract_One year <= 0.00  0.037018\n0.00 < cat__payment_Electronic check <= 1.00  0.036081\n                   cat__internet_DSL <= 0.00  0.029111\n             cat__internet_backup_No <= 0.00 -0.025897\n================================================================================\n"}],"key":"KLkyrgrCpq"}],"key":"PwYhbQpF42"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10  \nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"t0HFZbEzZ5"},{"type":"output","id":"CsuXDrYhN8gpVU_9AWh1D","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"4ab0f0948b8190edbf7e0b477dc5cae5","path":"/4ab0f0948b8190edbf7e0b477dc5cae5.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"V6511zKD6m"}],"key":"rJ5YFbQcMh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî  RandomForest + HP + SMOTE (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"TG6t4xt8X7"},{"type":"output","id":"7PT4EllAsM-0yPH8YLMIr","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1000242734.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c5481c3b56e484f65ea70a7fa39bbcc9","path":"/c5481c3b56e484f65ea70a7fa39bbcc9.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"zlNYKfmHdZ"}],"key":"AtsDiLrZI5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.2 Caso positivo de Churn (i=100)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wRaJUonn1D"}],"key":"QL8PsmbxGD"}],"identifier":"id-3-3-2-caso-positivo-de-churn-i-100","label":"3.3.2 Caso positivo de Churn (i=100)","html_id":"id-3-3-2-caso-positivo-de-churn-i-100","implicit":true,"key":"TMw0zdjkuK"}],"key":"hIrCYNpcAe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #100 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HWsyCHJdaB"}],"key":"oz7ElyU5eB"}],"key":"X4hLBhLIab"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = rf_final.named_steps[\"preprocessor\"]\nclassifier = rf_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"EgM3vW7W7I"},{"type":"output","id":"4OUY1nYwBuGdvt-9-2b_O","data":[],"key":"ax22InDIIE"}],"key":"UHxmu4OrUn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"MN29Dtm98d"},{"type":"output","id":"dan-6GRET5eS7XE-FWPl6","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #100\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.104 | S√≠: 0.896\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                              Caracter√≠stica      Peso\n 0.00 < cat__contract_Month-to-month <= 1.00  0.127851\n              cat__contract_Two year <= 0.00  0.107441\n    0.00 < cat__internet_Fiber optic <= 1.00  0.057844\n    0.00 < cat__internet_security_No <= 1.00  0.050673\n     0.00 < cat__internet_support_No <= 1.00  0.039019\n              cat__contract_One year <= 0.00  0.037405\n0.00 < cat__payment_Electronic check <= 1.00  0.029534\n                 num__charges_monthly > 0.83  0.025748\n                   cat__internet_DSL <= 0.00  0.025092\n             cat__internet_backup_No <= 0.00 -0.022727\n================================================================================\n"}],"key":"jn8awiiwlh"}],"key":"WoCKIQeALT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"eBnYBeyBSV"},{"type":"output","id":"9jvtw-2UGEK--xHe2ByYm","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d6075d9fb8e68d2ddbcbee1016a417e3","path":"/d6075d9fb8e68d2ddbcbee1016a417e3.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"zY5VIHlUuj"}],"key":"GBP0iUhsBO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî  RandomForest + HP + SMOTE (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"kw1mEBn9yJ"},{"type":"output","id":"FkyK6TEnBHGaX_Xfy6SbZ","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1000242734.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7da25138bf3dc564a9b4998cfc2db22d","path":"/7da25138bf3dc564a9b4998cfc2db22d.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"HEvy5RQDb2"}],"key":"PTo526W2XU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.3 Caso negativo de Churn (i=500)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YqEmoYr82K"}],"key":"CIpeKWmuSf"}],"identifier":"id-3-3-3-caso-negativo-de-churn-i-500","label":"3.3.3 Caso negativo de Churn (i=500)","html_id":"id-3-3-3-caso-negativo-de-churn-i-500","implicit":true,"key":"vJbttCVj27"}],"key":"qCQ9UzBN6I"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #500 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LlvVNu965O"}],"key":"ZKVRmvFcR5"}],"key":"mLCxz9CPMb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = rf_final.named_steps[\"preprocessor\"]\nclassifier = rf_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"Xzk5yynZ2m"},{"type":"output","id":"l4jbgYWDrwp7lSAaRQybu","data":[],"key":"xp7uILbVEt"}],"key":"nd1nJpNBTb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"THgJIwpXjr"},{"type":"output","id":"o2pxuqnIAYMHVSyOyhepy","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #500\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.953 | S√≠: 0.047\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                       Caracter√≠stica      Peso\n cat__contract_Month-to-month <= 0.00 -0.121935\n        cat__contract_Two year > 0.00 -0.111966\n                   num__tenure > 0.92 -0.067853\n    cat__internet_Fiber optic <= 0.00 -0.055226\n    cat__internet_security_No <= 0.00 -0.047913\n     cat__internet_support_No <= 0.00 -0.039761\n       cat__contract_One year <= 0.00  0.034803\ncat__payment_Electronic check <= 0.00 -0.028197\n            cat__internet_DSL <= 0.00  0.027670\n    0.00 < cat__paperless_Yes <= 1.00  0.023012\n================================================================================\n"}],"key":"lyUtBRzjis"}],"key":"JJVcXo5AOB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"J7BDyoffts"},{"type":"output","id":"pjQW2qO1BDr0Z_ekLCp8A","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"621f15963b74caa99f5f3006a28b1fd3","path":"/621f15963b74caa99f5f3006a28b1fd3.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"vnf3SAKtm2"}],"key":"TQxARK8tdu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî RandomForest + HP + SMOTE (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"fb3klRSNY7"},{"type":"output","id":"ZEtUl8f15m8i4D-QCR155","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1450505222.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb818e5a5152586b4ad34b03e05c4c16","path":"/bb818e5a5152586b4ad34b03e05c4c16.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"ZYIvFXBpRf"}],"key":"IkL6YZcKpp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.4 CatBoost Hiperparametrizado","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dGjHSJ3e9E"}],"key":"E9DLAL3F6T"}],"identifier":"id-3-4-catboost-hiperparametrizado","label":"3.4 CatBoost Hiperparametrizado","html_id":"id-3-4-catboost-hiperparametrizado","implicit":true,"key":"qTrCUxYWI4"}],"key":"nfwB4zfvR2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aqui, vamos a primero cargar el modelo.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mCRlB4Pdo8"}],"key":"EHHjFY4FtC"}],"key":"sxZbu203Ks"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cat_final = joblib.load(\"cat_hp_best.pkl\")\n\ncat_final","key":"XkYDyiENP0"},{"type":"output","id":"Cjg_jFmWKU_wws2b5ftLZ","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<style>#sk-container-id-13 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-13 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-13 pre {\n  padding: 0;\n}\n\n#sk-container-id-13 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-13 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-13 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-13 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-13 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-13 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-13 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-13 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-13 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-13 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-13 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-13 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-13 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-13 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-13 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"‚ñ∏\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-13 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-13 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-13 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-13 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-13 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-13 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-13 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"‚ñæ\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-13 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-13 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-13 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-13 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-13 div.sk-label label.sk-toggleable__label,\n#sk-container-id-13 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-13 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-13 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-13 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-13 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-13 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-13 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-13 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-13 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-13 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-13 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-13 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-13 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-13\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;clf&#x27;,\n                 &lt;catboost.core.CatBoostClassifier object at 0x00000233BEA691F0&gt;)])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-88\" type=\"checkbox\" ><label for=\"sk-estimator-id-88\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.pipeline.Pipeline.html\">?<span>Documentation for Pipeline</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,\n                 ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                                  [&#x27;tenure&#x27;,\n                                                   &#x27;charges_monthly&#x27;]),\n                                                 (&#x27;cat&#x27;,\n                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                                  [&#x27;gender&#x27;, &#x27;senior&#x27;,\n                                                   &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                                   &#x27;phone&#x27;, &#x27;phone_multiple&#x27;,\n                                                   &#x27;internet&#x27;,\n                                                   &#x27;internet_security&#x27;,\n                                                   &#x27;internet_backup&#x27;,\n                                                   &#x27;internet_protection&#x27;,\n                                                   &#x27;internet_support&#x27;,\n                                                   &#x27;streaming_tv&#x27;,\n                                                   &#x27;streaming_movies&#x27;,\n                                                   &#x27;contract&#x27;, &#x27;paperless&#x27;,\n                                                   &#x27;payment&#x27;])])),\n                (&#x27;clf&#x27;,\n                 &lt;catboost.core.CatBoostClassifier object at 0x00000233BEA691F0&gt;)])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-89\" type=\"checkbox\" ><label for=\"sk-estimator-id-89\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>preprocessor: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for preprocessor: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;, StandardScaler(),\n                                 [&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]),\n                                (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),\n                                 [&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;,\n                                  &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;,\n                                  &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;,\n                                  &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;,\n                                  &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;,\n                                  &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-90\" type=\"checkbox\" ><label for=\"sk-estimator-id-90\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>num</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;tenure&#x27;, &#x27;charges_monthly&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-91\" type=\"checkbox\" ><label for=\"sk-estimator-id-91\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-92\" type=\"checkbox\" ><label for=\"sk-estimator-id-92\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>cat</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;gender&#x27;, &#x27;senior&#x27;, &#x27;partner&#x27;, &#x27;dependents&#x27;, &#x27;phone&#x27;, &#x27;phone_multiple&#x27;, &#x27;internet&#x27;, &#x27;internet_security&#x27;, &#x27;internet_backup&#x27;, &#x27;internet_protection&#x27;, &#x27;internet_support&#x27;, &#x27;streaming_tv&#x27;, &#x27;streaming_movies&#x27;, &#x27;contract&#x27;, &#x27;paperless&#x27;, &#x27;payment&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-93\" type=\"checkbox\" ><label for=\"sk-estimator-id-93\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-94\" type=\"checkbox\" ><label for=\"sk-estimator-id-94\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>CatBoostClassifier</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>&lt;catboost.core.CatBoostClassifier object at 0x00000233BEA691F0&gt;</pre></div> </div></div></div></div></div></div>","content_type":"text/html"},"text/plain":{"content":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('num', StandardScaler(),\n                                                  ['tenure',\n                                                   'charges_monthly']),\n                                                 ('cat',\n                                                  OneHotEncoder(handle_unknown='ignore'),\n                                                  ['gender', 'senior',\n                                                   'partner', 'dependents',\n                                                   'phone', 'phone_multiple',\n                                                   'internet',\n                                                   'internet_security',\n                                                   'internet_backup',\n                                                   'internet_protection',\n                                                   'internet_support',\n                                                   'streaming_tv',\n                                                   'streaming_movies',\n                                                   'contract', 'paperless',\n                                                   'payment'])])),\n                ('clf',\n                 <catboost.core.CatBoostClassifier object at 0x00000233BEA691F0>)])","content_type":"text/plain"}}}],"key":"GdpGyhFdap"}],"key":"AknsSBiJJR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acto siguiente, vamos a observar cuales fueron las diez features mas importantes por modelo, de forma descendente.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QyLUuTQ2BB"}],"key":"QHEP27EdOg"}],"key":"qzx1dNKadY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cat_model = list(cat_final.named_steps.values())[-1] \nfeature_names = cat_final.named_steps[\"preprocessor\"].get_feature_names_out()\nimportances = cat_model.feature_importances_\n\nfeat_importance = (\n    pd.DataFrame({\"Feature\": feature_names, \"Importance\": importances})\n    .sort_values(by=\"Importance\", ascending=False)\n    .reset_index(drop=True)\n)\n\n\ntop10 = feat_importance.head(10)\n\nplt.figure(figsize=(10, 6))\nsns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\nplt.title(\"Top 10 Features m√°s importantes ‚Äî CatBoost + HP\", fontsize=14)\nplt.xlabel(\"Importancia\")\nplt.ylabel(\"Caracter√≠sticas\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()\n","key":"cY4KTqkWLw"},{"type":"output","id":"EdtdCEcihAGEYWT8QpwKh","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\777005001.py:15: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(data=top10, x=\"Importance\", y=\"Feature\", palette=\"Blues_r\")\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4d0030455f0b1539aace0f4cc862945f","path":"/4d0030455f0b1539aace0f4cc862945f.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"y2egS50mDf"}],"key":"fq1CXI6evT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aqui, los features mas importantes fueron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I9oyhFYv5Q"}],"key":"FL67eQCENZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"num_tenure, num_charges_monthly, cat_contract_Month-to-month, cat_payment_Electronic check y cat_payment_Back transfor (automatic)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iafVWnOSHb"}],"key":"FjJnuhuBfM"}],"key":"Qqll08hO3v"}],"key":"lqQyNM7TLx"}],"key":"toDlUtK29k"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.1 Caso mixto de Churn (i=10)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o1w2vInY5G"}],"key":"z5NGxsYGfm"}],"identifier":"id-3-3-1-caso-mixto-de-churn-i-10","label":"3.3.1 Caso mixto de Churn (i=10)","html_id":"id-3-3-1-caso-mixto-de-churn-i-10-1","implicit":true,"key":"LHgvb4KIqK"}],"key":"mS7PYR6bvc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #10 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sPcqU5olUi"}],"key":"BBUZTLD7Cf"}],"key":"muvKvzP3on"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = cat_final.named_steps[\"preprocessor\"]\nclassifier = cat_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"P3TD1jNIp3"},{"type":"output","id":"xh4IfGM89Fd4lileWPGyf","data":[],"key":"JfJ4YjpUh5"}],"key":"tYxjr7gaeD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"A3rJHcGsNG"},{"type":"output","id":"L8K0kE0kXlkjV7ZmdoHHc","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #10\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.894 | S√≠: 0.106\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                             Caracter√≠stica      Peso\n                         num__tenure > 0.92 -0.145752\n0.00 < cat__contract_Month-to-month <= 1.00  0.110127\n             cat__contract_Two year <= 0.00  0.076354\n   0.00 < cat__internet_Fiber optic <= 1.00  0.071606\n                num__charges_monthly > 0.83  0.049091\n    0.00 < cat__internet_support_No <= 1.00  0.037021\n          cat__internet_security_No <= 0.00 -0.031489\n  0.00 < cat__internet_security_Yes <= 1.00 -0.025109\n             cat__phone_multiple_No <= 0.00  0.023661\n                  cat__paperless_No <= 0.00  0.022551\n================================================================================\n"}],"key":"RNrPx9h8Gd"}],"key":"tNvyXo5DzY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 10  \nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"MsGcPbK0iK"},{"type":"output","id":"Prj1sO7WsDajrWDoYg1Fv","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"6f8e1592993cb664a95190ba0910d7d7","path":"/6f8e1592993cb664a95190ba0910d7d7.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"f60KWRj66a"}],"key":"g1LHudNv4s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî  CatBoost + HP (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"lmfMEHkvYs"},{"type":"output","id":"LA6WLOQqEAmpUdi01w8jm","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\925539086.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"85f794d674dd63674d16101062aeafc4","path":"/85f794d674dd63674d16101062aeafc4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"HarlJ0H8TH"}],"key":"BYnY2CAti3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.2 Caso positivo de Churn (i=100)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"otb9rG4IDo"}],"key":"AJl4sU7B14"}],"identifier":"id-3-3-2-caso-positivo-de-churn-i-100","label":"3.3.2 Caso positivo de Churn (i=100)","html_id":"id-3-3-2-caso-positivo-de-churn-i-100-1","implicit":true,"key":"WpLiO6gmt2"}],"key":"cGeSgBhYA5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #100 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gtcyLt8uP6"}],"key":"ygsxXOQtMT"}],"key":"Jds8MqmCEE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = cat_final.named_steps[\"preprocessor\"]\nclassifier = cat_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"Is3SeEmgPI"},{"type":"output","id":"b-G91Gz_gKIafmR520idj","data":[],"key":"eOFEvlQHCG"}],"key":"yIMdsfSSOC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"usXabmhF1Q"},{"type":"output","id":"4gJJsx85w7HIdwjcNIBli","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #100\n--------------------------------------------------------------------------------\nClase predicha: S√≠ Churn \nProbabilidades -> No: 0.242 | S√≠: 0.758\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                             Caracter√≠stica     Peso\n0.00 < cat__contract_Month-to-month <= 1.00 0.103377\n             cat__contract_Two year <= 0.00 0.081688\n   0.00 < cat__internet_Fiber optic <= 1.00 0.072533\n                num__charges_monthly > 0.83 0.057876\n    0.00 < cat__internet_support_No <= 1.00 0.039615\n   0.00 < cat__internet_security_No <= 1.00 0.034392\n             cat__phone_multiple_No <= 0.00 0.030209\n                  cat__paperless_No <= 0.00 0.025841\n             cat__contract_One year <= 0.00 0.024152\n                     cat__senior_Yes > 0.00 0.022402\n================================================================================\n"}],"key":"BHLlbWgBS4"}],"key":"CcWkR2d5HK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 100\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"xc0VCAJiPq"},{"type":"output","id":"Yh-qtw2nxKU1CRhwGq9zo","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"4b311b653566ba28120b6fffbd075ba7","path":"/4b311b653566ba28120b6fffbd075ba7.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"UB4x3JRabB"}],"key":"QZR8tcJ4J2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî  CatBoost + HP  (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"kY1xYWQEHu"},{"type":"output","id":"RU6sFosEwFfbjnH7MH5u-","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\1968648908.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"09f0cf85d7a6512b19ac67e4a45c5c2a","path":"/09f0cf85d7a6512b19ac67e4a45c5c2a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"Hkq347p7ZR"}],"key":"kGfr8jQHpz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3.3 Caso negativo de Churn (i=500)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cTeWh7UlZD"}],"key":"VbWMrZ10mq"}],"identifier":"id-3-3-3-caso-negativo-de-churn-i-500","label":"3.3.3 Caso negativo de Churn (i=500)","html_id":"id-3-3-3-caso-negativo-de-churn-i-500-1","implicit":true,"key":"j5jSHrKo4L"}],"key":"rI7jjFj7R8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Para esta seccion, vamos a ver como se compara este modelo con el registro #500 del dataset estudiado, y ver como se comparan los modelos y sus feature importances.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gw0KoKcR5L"}],"key":"gtZ0kSBkyg"}],"key":"eextHsWqic"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"preprocessor = cat_final.named_steps[\"preprocessor\"]\nclassifier = cat_final.named_steps[\"clf\"]\n\nX_train_trans = preprocessor.transform(X_train)\nX_test_trans = preprocessor.transform(X_test)\nfeature_names = preprocessor.get_feature_names_out()\n\nexplainer = LimeTabularExplainer(\n    training_data=np.array(X_train_trans),\n    feature_names=feature_names,\n    class_names=[\"No Churn\", \"S√≠ Churn\"],\n    mode=\"classification\"\n)","key":"TmXpJkG44v"},{"type":"output","id":"mZNcwSgnBd-RQp5UnQv9l","data":[],"key":"iVvA4kfK8W"}],"key":"RV9eh9br0h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\n\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=classifier.predict_proba,\n    num_features=10\n)\n\npred_proba = classifier.predict_proba([X_test_trans[i]])[0]\npred_class = np.argmax(pred_proba)\n\nlime_features = exp.as_list()\ndf_lime = pd.DataFrame(lime_features, columns=[\"Caracter√≠stica\", \"Peso\"])\ndf_lime[\"abs_peso\"] = df_lime[\"Peso\"].abs()\ndf_lime = df_lime.sort_values(by=\"abs_peso\", ascending=False).reset_index(drop=True)\n\nprint(\"=\" * 80)\nprint(f\"Interpretaci√≥n LIME ‚Äî Caso #{i}\")\nprint(\"-\" * 80)\nprint(f\"Clase predicha: {'S√≠ Churn ' if pred_class == 1 else 'No Churn '}\")\nprint(f\"Probabilidades -> No: {pred_proba[0]:.3f} | S√≠: {pred_proba[1]:.3f}\")\nprint(\"\\nTop 10 caracter√≠sticas m√°s influyentes:\")\nprint(df_lime[[\"Caracter√≠stica\", \"Peso\"]].to_string(index=False))\nprint(\"=\" * 80)\n","key":"ztY8RfBTqI"},{"type":"output","id":"kdiPdAUkq_x36dUSgMoWz","data":[{"name":"stdout","output_type":"stream","text":"================================================================================\nInterpretaci√≥n LIME ‚Äî Caso #500\n--------------------------------------------------------------------------------\nClase predicha: No Churn \nProbabilidades -> No: 0.979 | S√≠: 0.021\n\nTop 10 caracter√≠sticas m√°s influyentes:\n                      Caracter√≠stica      Peso\n                  num__tenure > 0.92 -0.145482\ncat__contract_Month-to-month <= 0.00 -0.105621\n   cat__internet_Fiber optic <= 0.00 -0.074210\n       cat__contract_Two year > 0.00 -0.072053\n       num__charges_monthly <= -0.97 -0.044454\n    cat__internet_support_No <= 0.00 -0.037209\n      cat__contract_One year <= 0.00  0.031873\n   cat__internet_security_No <= 0.00 -0.031306\n      cat__phone_multiple_No <= 0.00  0.027877\n           cat__internet_DSL <= 0.00  0.024821\n================================================================================\n"}],"key":"NhYr5e70I4"}],"key":"FEnmZ8UTij"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i = 500\nexp = explainer.explain_instance(\n    data_row=X_test_trans[i],\n    predict_fn=xgb_model.predict_proba,\n    num_features=10\n)\n\nexp.show_in_notebook(show_table=True)","key":"WlWlqJeolI"},{"type":"output","id":"LBhQFiX8mlapPKkrW4zqx","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"7b7b99f0634176fecf27ef7a71002fdc","path":"/7b7b99f0634176fecf27ef7a71002fdc.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"gLKI0k1Oop"}],"key":"lyzxsKbQlM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\ncolors = [\"#d62728\" if w > 0 else \"#1f77b4\" for w in df_lime[\"Peso\"]]\n\nsns.barplot(\n    data=df_lime.sort_values(by=\"Peso\", ascending=True),\n    x=\"Peso\",\n    y=\"Caracter√≠stica\",\n    palette=colors\n)\n\nplt.title(f\"LIME ‚Äî CatBoost + HP (Caso #{i})\", fontsize=13)\nplt.xlabel(\"Impacto en la predicci√≥n (Peso)\")\nplt.ylabel(\"\")\nplt.grid(axis=\"x\", linestyle=\"--\", alpha=0.6)\nplt.tight_layout()\nplt.show()","key":"bI35QQ8VCh"},{"type":"output","id":"a9i99Pk8Baxb5aGZiT7Wt","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\2794980300.py:4: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"950dff41f36cfaecbcdc80b54c0b7624","path":"/950dff41f36cfaecbcdc80b54c0b7624.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"dNVqjI1TLY"}],"key":"ZyvEtbhtxP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.5 Comparacion final entre modelos","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wK67bbOZKf"}],"key":"J6RFstgXZP"}],"identifier":"id-3-5-comparacion-final-entre-modelos","label":"3.5 Comparacion final entre modelos","html_id":"id-3-5-comparacion-final-entre-modelos","implicit":true,"key":"lcfgcS1tIu"}],"key":"Mk29QzzqpX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"models = {\n    \"XGBoost + HP\": pipe_xgb,\n    \"LightGBM + HP + is_unbalanced=True (GPU)\": pipe_lgb,\n    \"RandomForest + HP + SMOTE (GPU)\": pipe_rf,\n    \"CatBoost + HP\": pipe_cat\n}\n\nfeature_orig = X_train.columns\n","key":"kTlbvUnF3F"},{"type":"output","id":"xHlhXAKnFojjAGmUcKJ4f","data":[],"key":"EbrFXB6TIi"}],"key":"ccmAXSNwJd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"models_fitted = {\n    \"XGBoost + HP\": grid_xgb.best_estimator_,\n    \"LightGBM + HP + is_unbalanced=True (GPU)\": grid_lgb.best_estimator_,\n    \"RandomForest + HP + SMOTE (GPU)\": grid_rf.best_estimator_,\n    \"CatBoost + HP\": grid_cat.best_estimator_\n}\n","key":"em0fZ1D0gX"},{"type":"output","id":"er7LmcK3ikHsTdp6aPdoO","data":[],"key":"kyJYABfwLE"}],"key":"i4euYuMWIi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"feature_importances = {}\n\nfor name, pipe in models_fitted.items():\n    feature_names = pipe.named_steps[\"preprocessor\"].get_feature_names_out()\n    clf = pipe.named_steps[\"clf\"]\n\n    if hasattr(clf, \"feature_importances_\"):\n        importances = clf.feature_importances_\n    elif \"CatBoost\" in name:\n        importances = clf.get_feature_importance()\n    else:\n        importances = np.zeros(len(feature_names))\n\n    df_imp = pd.DataFrame({\n        \"Feature\": feature_names,\n        \"Importance\": importances\n    }).sort_values(\"Importance\", ascending=False).reset_index(drop=True)\n\n    feature_importances[name] = df_imp\n","key":"sG92Qidyo2"},{"type":"output","id":"-iZ-vKBtMWXbictl6Tey2","data":[],"key":"tBytJPHlKB"}],"key":"h5vf6uhBqK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nplt.figure(figsize=(18, 12))\nfor i, (name, df_imp) in enumerate(feature_importances.items(), 1):\n    plt.subplot(2, 2, i)\n    top10 = df_imp.head(10)\n    sns.barplot(\n        data=top10.sort_values(\"Importance\", ascending=True),\n        x=\"Importance\",\n        y=\"Feature\",\n        palette=\"Blues\"\n    )\n    plt.title(f\"Top 10 Features ‚Äî {name}\", fontsize=12)\n    plt.xlabel(\"Importancia\")\n    plt.ylabel(\"\")\n    plt.grid(axis=\"x\", linestyle=\"--\", alpha=0.5)\n\nplt.tight_layout()\nplt.show()\n","key":"BufzKhsL1z"},{"type":"output","id":"oWjbBAP4BmTB8kWUuZlS5","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3630990556.py:5: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\nC:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3630990556.py:5: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\nC:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3630990556.py:5: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\nC:\\Users\\taran\\AppData\\Local\\Temp\\ipykernel_19104\\3630990556.py:5: FutureWarning: \n\nPassing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.\n\n  sns.barplot(\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7025d766b66e79f3ee798d2371f61572","path":"/7025d766b66e79f3ee798d2371f61572.png"},"text/plain":{"content":"<Figure size 1800x1200 with 4 Axes>","content_type":"text/plain"}}}],"key":"ptI9Y5uuPW"}],"key":"G5AOWnKrQp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"top_n = 21  \nall_features = set()\n\nfor df in feature_importances.values():\n    all_features.update(df.head(top_n)[\"Feature\"].tolist())\n\nall_features = list(all_features)\n\nheatmap_df = pd.DataFrame(index=all_features)\n\nfor name, df in feature_importances.items():\n    temp = df.set_index(\"Feature\")[\"Importance\"]\n    heatmap_df[name] = temp\n\nheatmap_df = heatmap_df.fillna(0)\n\nheatmap_norm = heatmap_df / heatmap_df.max()\n\nplt.figure(figsize=(12, 10))\nsns.heatmap(\n    heatmap_norm, \n    annot=True, \n    cmap=\"Blues\", \n    cbar_kws={'label': 'Importancia relativa'}, \n    linewidths=0.5\n)\nplt.title(\"Comparaci√≥n de Feature Importances - Top Features\", fontsize=16)\nplt.ylabel(\"Caracter√≠sticas\")\nplt.xlabel(\"Modelo\")\nplt.tight_layout()\nplt.show()\n","key":"mkMD9QL7af"},{"type":"output","id":"BSLsWzcF1jlTwrBi7ZI6t","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"154badfd41ea7d2058758bb55a4c5835","path":"/154badfd41ea7d2058758bb55a4c5835.png"},"text/plain":{"content":"<Figure size 1200x1000 with 2 Axes>","content_type":"text/plain"}}}],"key":"ZCDOmGtTL7"}],"key":"rBKJ8RXmmM"}],"key":"FiPsiPohZE"},"references":{"cite":{"order":[],"data":{}}}}